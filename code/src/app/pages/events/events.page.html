<app-header-back title="Eventos"></app-header-back>
<ion-content padding>
    <p
        style="position: fixed;top: 3rem;left: 40%;background: black;color: white; padding: 1rem;z-index: 1000;">
        Num Eventos {{eventsList.length}}
    </p>
    <!-- Mensaje cuando no se pudieron cargar los datos-->
    <div class="flex-column-center message-fail-load"
        *ngIf="eventsLoaded && eventsList.length === 0">
        <p>No se pudieron cargar los Eventos</p>
    </div>
    <!-- Tarjetas Animacion hasta cargar datos-->
    <div *ngIf="!eventsLoaded">
        <ion-card *ngFor="let event of [1,1,1,1]" class="event animated flash slow infinite">
            <ion-card-header>
                <ion-card-subtitle>
                    <ion-skeleton-text width="60%"></ion-skeleton-text>
                </ion-card-subtitle>
                <ion-card-title>
                    <ion-skeleton-text width="30%"></ion-skeleton-text>
                </ion-card-title>
            </ion-card-header>
            <ion-card-content>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
            </ion-card-content>
            <ion-row>
                <ion-col size="6">
                    <ion-item lines="none" detail="false" button="true" class="container_events">
                        <ion-skeleton-text width="70%"></ion-skeleton-text>
                    </ion-item>
                </ion-col>
                <ion-col size="6">
                    <ion-item class="container_events" detail="false" button="true" lines="none">
                        <ion-skeleton-text width="70%"></ion-skeleton-text>
                    </ion-item>
                </ion-col>
            </ion-row>
        </ion-card>
    </div>
    <!-- Tarjeta Datos Cargados y Disponibles -->
    <div *ngIf="eventsLoaded  && eventsList.length > 0">
        <ion-card class="event" *ngFor="let event of eventsList; let i = index;" (click)="postDetail(event.id)">
            <!--<div class="event-image" *ngIf="event.images && event.images.length > 0">
                <img [src]="event.images[0].url" alt="Imagen Tarjeta" class="img" />
            </div>-->
            <ion-card-header class="event-header">
                <ion-card-title class="event-title">
                    <span>{{event.title}}</span>
                </ion-card-title>
            </ion-card-header>
            <ion-card-content class="main-post-info">
                <p class="item-info">
                    <span class="icon-fulldate">
                        <ion-icon name="calendar"></ion-icon>
                    </span>
                    <span class="description"> {{ event.fulldate }} </span>
                </p>
                <p class="item-info">
                    <span class="icon-ubication">
                        <ion-icon name="pin"></ion-icon>
                    </span>
                    <span class="description">
                        {{ (event.ubication && event.ubication.address) ? event.ubication.address : 'Direccion no encontrada' }}
                    </span>
                </p>
            </ion-card-content>
            <div class="social">
                <div class="social-content">
                    <span *ngIf="event.postAssistance">A ti y {{event.details.length}} personas mÃ¡s les interesa</span>
                     <span *ngIf="!event.postAssistance">
                        A {{event.details.length}} 
                        {{(event.details.length === 1) ? 'persona le interesa' : 'personas les interesa'}}
                    </span>
                </div>
                <div class="social-options">
                    <div class="social-button"
                        [class.active]="event.postAssistance"
                        (click)="toggleAssistance(event.postAssistance, event.id)">
                        <ion-icon class="assistance" name="star"></ion-icon>
                        <span>Me interesa</span>
                    </div>
                    <div class="social-button" (click)="sharePost(event)">
                        <ion-icon class="share" name="share"></ion-icon>
                        <span><i class="fa fa-share"></i>Compartir</span>
                    </div>
                </div>

            </div>
        </ion-card>
    </div>
    <!--Opciones del FabButton -->
    <ion-fab vertical="bottom" horizontal="center" slot="fixed">
        <ion-fab-button color="primary" size="small">
            <ion-icon name="ios-keypad"></ion-icon>
        </ion-fab-button>
        <ion-fab-list side="top">
            <ion-fab-button (click)="showModalSearchEvents()">
                <ion-icon name="search"></ion-icon>
            </ion-fab-button>
        </ion-fab-list>
    </ion-fab>
    <!-- Scroll Infinito -->
    <ion-infinite-scroll threshold="175px" (ionInfinite)="getInfiniteScrollData($event)">
        <ion-infinite-scroll-content loadingSpinner="crescent"
            loadingText="Cargando Publicaciones...">
        </ion-infinite-scroll-content>
    </ion-infinite-scroll>
</ion-content>
