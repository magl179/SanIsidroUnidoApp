<app-header-back title="Problemas Sociales"></app-header-back>

<ion-toolbar mode="md">
    <ion-segment color="tertiary" scrollable mode="md" (ionChange)="segmentChanged($event)">
        <ion-segment-button value="all" mode="md">
            <ion-label>Todos</ion-label>
        </ion-segment-button>
        <ion-segment-button value="1" mode="md">
            <ion-label>Transporte & Transito</ion-label>
        </ion-segment-button>
        <ion-segment-button value="2" mode="md">
            <ion-label>Espacios Verdes</ion-label>
        </ion-segment-button>
        <ion-segment-button value="3" mode="md">
            <ion-label>Seguridad</ion-label>
        </ion-segment-button>
        <ion-segment-button value="4" mode="md">
            <ion-label>Protección Animal</ion-label>
        </ion-segment-button>
    </ion-segment>
</ion-toolbar>
<ion-content>
    <!-- Animacion Tarjeta hasta tener los Datos Cargados -->
    <div *ngIf="socialProblems === null || socialProblems.length === 0">
        <ion-card *ngFor="let items of [1,1,1,1]" class="card_social animated flash slow infinite">
            <ion-card-header>
                <ion-card-title>
                    <ion-skeleton-text width="40%"></ion-skeleton-text>
                </ion-card-title>
                <ion-card-subtitle class="post_user">
                    <ion-skeleton-text width="40%"></ion-skeleton-text>
                </ion-card-subtitle>
                <ion-card-subtitle>
                    <ion-skeleton-text width="50%"></ion-skeleton-text>
                </ion-card-subtitle>
            </ion-card-header>
            <ion-card-content class="post_description">
                <p class="post_content">
                    <ion-skeleton-text width="70%"></ion-skeleton-text>
                    <ion-skeleton-text width="70%"></ion-skeleton-text>
                </p>
                <p>
                    <ion-skeleton-text width="20%"></ion-skeleton-text>
                </p>
            </ion-card-content>
            <div class="options">
                <div class="option_button">
                    <button class="btn primary">
                        <ion-skeleton-text width="70%"></ion-skeleton-text>
                        <ion-ripple-effect></ion-ripple-effect>
                    </button>
                </div>
                <div class="option_actions">
                    <div class="btn_icon" style="width: 50%;height: 30px;">
                        <ion-skeleton-text width="55%"></ion-skeleton-text>
                    </div>
                    <div class="btn_icon" style="width: 50%;height: 30px;">
                        <ion-skeleton-text width="55%"></ion-skeleton-text>
                    </div>
                </div>
            </div>
        </ion-card>
    </div>
    <!-- Tarjeta con Datos Cargados -->
    <ion-card class="card_social"
        *ngFor="let socialProblem of (socialProblems) | filtroSearch:subcategory:'category_id'; let i = index;">
        <div *ngIf="socialProblem.exists === -1">
            <ion-card-header class="ion-text-center">
                <ion-card-title>No hay publicaciones en esta categoria :( </ion-card-title>
            </ion-card-header>
        </div>
        <div *ngIf="socialProblem.exists !== -1">
            <ion-card-header>
                <ion-card-title>{{socialProblem.title}}</ion-card-title>
                <ion-card-subtitle class="post_user">User ID: {{socialProblem.user_id}}
                </ion-card-subtitle>
                <ion-card-subtitle>Category ID: {{socialProblem.category_id}} | {{socialProblem.date | beafitulDate}}
                </ion-card-subtitle>
            </ion-card-header>
            <ion-card-content class="post_description">
                <p class="post_content">{{socialProblem.description}} </p>
                <p>Likes: 11</p>
            </ion-card-content>
            <div class="options">
                <div class="option_button">
                    <button class="btn primary" (click)="postDetail(socialProblem.id)">
                        Ver más
                        <ion-ripple-effect></ion-ripple-effect>
                    </button>
                </div>
                <div class="option_actions">
                    <div class="btn_icon" [ngClass]="{'active': socialProblem.user_id === currentUser.id}">
                        <ion-icon slot="icon-only"
                            [name]="(socialProblem.user_id === currentUser.id)?'heart':'heart-empty'"></ion-icon>
                    </div>
                    <div (click)="sharePost(socialProblem)" class="btn_icon">
                        <ion-icon slot="icon-only" name="share" style="font-size:1.3rem;"></ion-icon>
                    </div>
                </div>
            </div>
        </div>
    </ion-card>
    <!-- Scroll Infinito -->
    <ion-infinite-scroll threshold="150px" (ionInfinite)="getInfiniteScrollData($event)">
            <ion-infinite-scroll-content loadingSpinner="crescent" loadingText="Cargando Publicaciones...">
            </ion-infinite-scroll-content>
    </ion-infinite-scroll>
</ion-content>