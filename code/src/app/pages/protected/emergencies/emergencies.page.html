<app-header-back title="Mis Emergencias"></app-header-back>

<ion-content padding>
    <ion-toolbar>
        <ion-buttons slot="secondary">
           <ion-button (click)="reportEmergency()">
             <ion-icon slot="icon-only" name="send"></ion-icon>
           </ion-button>
           <ion-button (click)="showModalSearchEmergencies()">
             <ion-icon slot="icon-only" name="search"></ion-icon>
           </ion-button>
         </ion-buttons>
         <ion-buttons slot="primary">
           <ion-button (click)="showModalFilterEmergencies()">
             <ion-icon slot="icon-only" name="options"></ion-icon>
           </ion-button>
         </ion-buttons>
        <!-- <ion-title>Opciones</ion-title> -->
       </ion-toolbar>
    <!-- <ion-grid>
        <ion-row class="ion-align-items-center">
            <ion-grid size="4" style="display:flex;justify-content:center;">
                <ion-button color="primary" (click)="showModalSearchEmergencies()">
                    Buscar <ion-icon name="search" slot="end"></ion-icon>
            </ion-button>
            </ion-grid>
            <ion-grid size="4" style="display:flex;justify-content:center;">
                <ion-button color="primary" (click)="reportEmergency()">
                    Reportar <ion-icon name="send" slot="end"></ion-icon>
                </ion-button>
            </ion-grid>
            <ion-grid size="4">
                <ion-button color="primary" (click)="showModalFilterEmergencies()">
                    Filtrar <ion-icon name="options" slot="end"></ion-icon>
                </ion-button>
            </ion-grid>
        </ion-row>
    </ion-grid> -->
    <!-- <div>
        <ion-searchbar animated debounce="500" showCancelButton="focus"
            placeholder="Buscar Mis Emergencias" [value]="textoEmergenciaBuscar" (ionChange)="searchEmergencies($event)"></ion-searchbar>
    </div> -->
    <ion-grid *ngIf="searchingEmergencies">
        <ion-row>
            <ion-col text-center>
                <ion-spinner name="crescent"></ion-spinner>
            </ion-col>
        </ion-row>
    </ion-grid>
    <!-- Tarjetas Animacion hasta cargar datos-->
    <div *ngIf="!emergencies || emergencies.length === 0">
        <ion-card *ngFor="let emergencies of [1,1,1,1,1,1,1];"
            class="event_item animated flash slow infinite">
            <ion-card-header>
                <ion-card-subtitle>
                    <ion-skeleton-text width="60%"></ion-skeleton-text>
                </ion-card-subtitle>
                <ion-card-title>
                    <ion-skeleton-text width="30%"></ion-skeleton-text>
                </ion-card-title>
            </ion-card-header>
            <ion-card-content>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
            </ion-card-content>
            <ion-row>
                <ion-col size="6">
                    <ion-item lines="none" detail="false" button="true" class="container_events">
                        <ion-skeleton-text width="70%"></ion-skeleton-text>
                    </ion-item>
                </ion-col>
                <ion-col size="6">
                    <ion-item class="container_events" detail="false" button="true" lines="none">
                        <ion-skeleton-text width="70%"></ion-skeleton-text>
                    </ion-item>
                </ion-col>
            </ion-row>
        </ion-card>
    </div>
    <!-- Tarjetas con Datos -->
    <div *ngIf="emergencies  && emergencies.length > 0">
        <ion-card class="emergency_card" *ngFor="let emergencie of emergenciesFiltered; let i = index;">
            <ion-card-header (click)="postDetail(emergencie.id)" class="emergency_card_header">
                <ion-card-subtitle class="emergency_info">
                    <span class="emergency_date">
                            <ion-icon name="calendar"></ion-icon> 
                            {{getFullDate(emergencie.date, emergencie.time) | simpleBeatifulDate}}
                          </span>
                          <span class="emergency_address">
                            <ion-icon name="navigate"></ion-icon>
                            {{ emergencie.ubication.address || 'Direccion no encontrada'}}
                          </span>
                </ion-card-subtitle>
                <ion-card-title class="emergency_card_title">{{emergencie.title}}</ion-card-title>
            </ion-card-header>
           
            <ion-card-content class="emergency_card_content">
                    <p class="post_description">
                            {{emergencie.description | truncate: 50}}
                    </p>
                    <p class="see-more" (click)="postDetail(emergencie.id)">Ver m√°s...</p>
            </ion-card-content>
        </ion-card>
    </div>
</ion-content>
