<app-header-back title="Mis Emergencias"></app-header-back>

<ion-content padding>
    <div class="flex-column-center message-fail-load"
        *ngIf="emergenciesLoaded && emergenciesList.length === 0">
        <p>No se pudieron cargar tus emergencias reportadas</p>
        <ion-button (click)="loadEmergencies()">Toca para reintentar</ion-button>
    </div>
    <!-- Tarjetas Animacion hasta cargar datos-->
    <div *ngIf="!emergenciesLoaded">
        <ion-card *ngFor="let animations of [1,1,1,1,1,1,1];"
            class="event_item animated flash slow infinite">
            <ion-card-header>
                <ion-card-subtitle>
                    <ion-skeleton-text width="60%"></ion-skeleton-text>
                </ion-card-subtitle>
                <ion-card-title>
                    <ion-skeleton-text width="30%"></ion-skeleton-text>
                </ion-card-title>
            </ion-card-header>
            <ion-card-content>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
            </ion-card-content>
            <ion-row>
                <ion-col size="6">
                    <ion-item lines="none" detail="false" button="true" class="container_events">
                        <ion-skeleton-text width="70%"></ion-skeleton-text>
                    </ion-item>
                </ion-col>
                <ion-col size="6">
                    <ion-item class="container_events" detail="false" button="true" lines="none">
                        <ion-skeleton-text width="70%"></ion-skeleton-text>
                    </ion-item>
                </ion-col>
            </ion-row>
        </ion-card>
    </div>
    <!-- Tarjetas con Datos -->
    <div *ngIf="emergenciesLoaded  && emergenciesList.length > 0">
        <ion-card class="emergency_card"
            *ngFor="let emergency of emergenciesFiltered; let i = index;">
            <ion-card-header (click)="postDetail(emergency.id)" class="emergency_card_header">
                <ion-card-title class="emergency_card_title">{{emergency.title}}</ion-card-title>
            </ion-card-header>

            <ion-card-content class="emergency_card_content">
                <p class="post_description">
                    {{emergency.description | truncate: 50}}
                </p>
                <p class="see-more" (click)="postDetail(emergency.id)">Ver m√°s...</p>
                <ion-chip class="post-state" [class.active]="(emergency.is_attended)">
                    <ion-icon [name]="(emergency.is_attended)?'checkmark':'close'"></ion-icon>
                    <ion-label>{{(emergency.is_attended)?'Atendida':'Pendiente'}}</ion-label>
                </ion-chip>
            </ion-card-content>
        </ion-card>
    </div>
    <!--Opciones -->
    <ion-fab vertical="bottom" horizontal="end" slot="fixed">
        <ion-fab-button color="primary">
            <ion-icon name="md-more"></ion-icon>
        </ion-fab-button>
        <ion-fab-list side="top">
            <ion-fab-button (click)="showModalSearchEmergencies()">
                <ion-icon name="search"></ion-icon>
            </ion-fab-button>
            <ion-fab-button (click)="showModalFilterEmergencies()">
                <ion-icon name="options"></ion-icon>
            </ion-fab-button>
            <ion-fab-button (click)="this.reportEmergency()">
                <ion-icon name="send"></ion-icon>
            </ion-fab-button>
        </ion-fab-list>
    </ion-fab>
</ion-content>
