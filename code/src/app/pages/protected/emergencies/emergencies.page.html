<app-header-back title="Mis Emergencias" [searchAvalaible]="true" [filterAvalaible]="true"
    [reportAvalaible]="true" (returnHeaderBackData)="getHeaderBackData($event)"></app-header-back>

<ion-content padding>
    <div class="flex-column-center message-fail-load" *ngIf="emergenciesLoaded && emergenciesList.length === 0">
        <p>No se pudieron cargar tus emergencias reportadas</p>
        <ion-button (click)="loadEmergencies()">Toca para reintentar</ion-button>
    </div>
    <!-- Tarjetas Animacion hasta cargar datos-->
    <div *ngIf="!emergenciesLoaded">
        <ion-card *ngFor="let animations of [1,1,1,1,1,1,1];"
            class="event_item animated flash slow infinite">
            <ion-card-header>
                <ion-card-subtitle>
                    <ion-skeleton-text width="60%"></ion-skeleton-text>
                </ion-card-subtitle>
                <ion-card-title>
                    <ion-skeleton-text width="30%"></ion-skeleton-text>
                </ion-card-title>
            </ion-card-header>
            <ion-card-content>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
                <ion-skeleton-text width="100%"></ion-skeleton-text>
            </ion-card-content>
            <ion-row>
                <ion-col size="6">
                    <ion-item lines="none" detail="false" button="true" class="container_events">
                        <ion-skeleton-text width="70%"></ion-skeleton-text>
                    </ion-item>
                </ion-col>
                <ion-col size="6">
                    <ion-item class="container_events" detail="false" button="true" lines="none">
                        <ion-skeleton-text width="70%"></ion-skeleton-text>
                    </ion-item>
                </ion-col>
            </ion-row>
        </ion-card>
    </div>
    <!-- Tarjetas con Datos -->
    <div *ngIf="emergenciesLoaded  && emergenciesList.length > 0">
        <ion-card class="emergency_card"
            *ngFor="let emergencie of emergenciesFiltered; let i = index;">
            <ion-card-header (click)="postDetail(emergencie.id)" class="emergency_card_header">
                <ion-card-subtitle class="emergency_info">
                    <span class="emergency_date">
                        <ion-icon name="calendar"></ion-icon>
                        {{getFullDate(emergencie.date, emergencie.time) | simpleBeatifulDate}}
                    </span>
                    <span class="emergency_address">
                        <ion-icon name="navigate"></ion-icon>
                        {{ emergencie.ubication.address || 'Direccion no encontrada'}}
                    </span>
                </ion-card-subtitle>
                <ion-card-title class="emergency_card_title">{{emergencie.title}}</ion-card-title>
            </ion-card-header>

            <ion-card-content class="emergency_card_content">
                <p class="post_description">
                    {{emergencie.description | truncate: 50}}
                </p>
                <p class="see-more" (click)="postDetail(emergencie.id)">Ver m√°s...</p>
            </ion-card-content>
        </ion-card>
    </div>
</ion-content>
